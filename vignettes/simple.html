<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link rel="stylesheet" href="simm.css" type="text/css" />
</head>
<body>
<h1 id="simple-tutorial">Simple Tutorial</h1>
<h2 id="load-simr">Load <code>simr</code></h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">load_all</span>(, <span class="dt">reset =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>## Loading simr
## Loading required namespace: lme4
## Loading required namespace: plyr
## Loading required namespace: binom
## Loading required namespace: plotrix
## Loading required package: lme4
## Loading required package: lattice
## Loading required package: Matrix
## Loading required package: plyr
## Loading required package: binom
## Loading required package: plotrix
## Loading required package: stringr</code></pre>
<h2 id="building-a-simple-model">Building a simple model</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(example)</code></pre>
<pre><code>##         y  x g       z
## 1   8.139  1 a -1.6814
## 2   7.948  2 a -1.6814
## 3   9.284  3 a -1.6814
## 4   7.779  4 a -1.6814
## 5   5.804  5 a -1.6814
## 6   6.132  6 a -1.6814
## 7   6.123  7 a -1.6814
## 8   7.543  8 a -1.6814
## 9   6.428  9 a -1.6814
## 10  6.219 10 a -1.6814
## 11  9.170  1 b -0.6905
## 12  8.254  2 b -0.6905
## 13 10.346  3 b -0.6905
## 14  8.807  4 b -0.6905
## 15  6.093  5 b -0.6905
## 16  8.511  6 b -0.6905
## 17  7.087  7 b -0.6905
## 18  6.242  8 b -0.6905
## 19  6.841  9 b -0.6905
## 20  5.783 10 b -0.6905
## 21 13.697  1 c  4.6761
## 22 13.551  2 c  4.6761
## 23 12.239  3 c  4.6761
## 24 14.514  4 c  4.6761
## 25 13.579  5 c  4.6761
## 26 12.038  6 c  4.6761
## 27 14.180  7 c  4.6761
## 28 13.103  8 c  4.6761
## 29 12.131  9 c  4.6761
## 30 13.071 10 c  4.6761</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(example)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span><span class="kw">lmer</span>(y ~<span class="st"> </span>x +<span class="st"> </span>(<span class="dv">1</span> |<span class="st"> </span>g), <span class="dt">data =</span> example)
gcol &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">a =</span> lcgreen, <span class="dt">b =</span> lcblue, <span class="dt">c =</span> lcbrown)
gbg &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">a =</span> lclightgreen, <span class="dt">b =</span> lclightblue, <span class="dt">c =</span> lclightbrown)
<span class="co"># gpch &lt;- c(a=0, b=1, c=2)</span>
<span class="kw">plot</span>(x, y, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">pch =</span> <span class="dv">21</span>, <span class="dt">col =</span> gcol[g], <span class="dt">bg =</span> gbg[g])
tmp &lt;-<span class="st"> </span><span class="kw">mapply</span>(abline, <span class="kw">unique</span>(z) +<span class="st"> </span><span class="dv">10</span>, -<span class="dv">1</span>/<span class="dv">2</span>, <span class="dt">col =</span> gcol)</code></pre>
<div class="figure">
<img src="figure/unnamed-chunk-4.svg" alt="plot of chunk unnamed-chunk-4" /><p class="caption">plot of chunk unnamed-chunk-4</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ci_abline(fit)</span></code></pre>
<h2 id="analysis">Analysis</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(fit)</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: y ~ x + (1 | g) 
##    Data: example 
## 
## REML criterion at convergence: 97.07 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  g        (Intercept) 11.136   3.337   
##  Residual              0.972   0.986   
## Number of obs: 30, groups: g, 3
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  10.6734     1.9655    5.43
## x            -0.2398     0.0627   -3.83
## 
## Correlation of Fixed Effects:
##   (Intr)
## x -0.175</code></pre>
<h2 id="subsets">Subsets</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))

<span class="kw">plot</span>(x, y, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">lwd =</span> <span class="dv">2</span>)
fit1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y ~<span class="st"> </span>x, <span class="dt">subset =</span> <span class="dv">1</span>:<span class="dv">8</span>)
<span class="co"># ci_abline(fit1)</span>

<span class="kw">plot</span>(x, y, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">lwd =</span> <span class="dv">2</span>)
fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y ~<span class="st"> </span>x, <span class="dt">subset =</span> <span class="dv">1</span>:<span class="dv">6</span>)
<span class="co"># ci_abline(fit2)</span>

<span class="kw">plot</span>(x, y, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">lwd =</span> <span class="dv">2</span>)</code></pre>
<div class="figure">
<img src="figure/unnamed-chunk-6.svg" alt="plot of chunk unnamed-chunk-6" /><p class="caption">plot of chunk unnamed-chunk-6</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r">fit3 &lt;-<span class="st"> </span><span class="kw">lm</span>(y ~<span class="st"> </span>x, <span class="dt">subset =</span> <span class="dv">1</span>:<span class="dv">4</span>)
<span class="co"># ci_abline(fit3)</span></code></pre>
<h2 id="power-analysis">Power Analysis</h2>
<pre class="sourceCode r"><code class="sourceCode r">pa &lt;-<span class="st"> </span><span class="kw">powercurve</span>(fit)</code></pre>
<pre><code>## ===========================================================================</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(pa)</code></pre>
<div class="figure">
<img src="figure/unnamed-chunk-8.svg" alt="plot of chunk unnamed-chunk-8" /><p class="caption">plot of chunk unnamed-chunk-8</p>
</div>
</body>
</html>
