<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link rel="stylesheet" href="simr.css" type="text/css" />
</head>
<body>
<h1 id="simr-an-r-package-for-power-analysis-of-linear-mixed-models-by-simulation">simr: an R Package for Power Analysis of Linear Mixed Models by Simulation</h1>
<p>Simplified version of the paper, with the R excerpts.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">load_all</span>(<span class="dt">export_all =</span> <span class="ot">FALSE</span>)</code></pre>
<h2 id="example-data">Example Data</h2>
<div class="figure">
<img src="figure/example.svg" alt="plot of chunk example" /><p class="caption">plot of chunk example</p>
</div>
<h2 id="tutorial-one">Tutorial One</h2>
<p>Post-hoc power analyses.</p>
<pre class="sourceCode r"><code class="sourceCode r">model1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(y ~<span class="st"> </span>x +<span class="st"> </span>(<span class="dv">1</span> |<span class="st"> </span>g), <span class="dt">data =</span> example)
<span class="kw">summary</span>(model1)</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: y ~ x + (1 | g)
##    Data: example
## 
## REML criterion at convergence: 97.1
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.7799 -0.6563 -0.0494  0.6809  2.0483 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  g        (Intercept) 11.136   3.337   
##  Residual              0.972   0.986   
## Number of obs: 30, groups: g, 3
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  10.6734     1.9655    5.43
## x            -0.2398     0.0627   -3.83
## 
## Correlation of Fixed Effects:
##   (Intr)
## x -0.175</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">powerSim</span>(model1)</code></pre>
<pre><code>## Power to detect effect of x, (95% confidence interval):
##  96.60% ( 95.28,  97.63)
## 
## Based on 1000 simulations and effect size -0.24</code></pre>
<h2 id="tutorial-two">Tutorial Two</h2>
<p>Calculate a power curve.</p>
<pre class="sourceCode r"><code class="sourceCode r">pc1 &lt;-<span class="st"> </span><span class="kw">powerCurve</span>(model1)</code></pre>
<pre><code>## Calculating power at 8 sample sizes for x</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(pc1)</code></pre>
<pre><code>## Power to detect effect of x, (95% confidence interval):
## #levels for x 
##       3:  11.10% (  9.22,  13.21)
##       4:  16.80% ( 14.53,  19.26)
##       5:  27.40% ( 24.66,  30.28)
##       6:  44.70% ( 41.59,  47.84)
##       7:  61.80% ( 58.71,  64.82)
##       8:  76.20% ( 73.44,  78.81)
##       9:  87.80% ( 85.61,  89.76)
##      10:  95.20% ( 93.69,  96.44)
## 
## Time elapsed: 0 h 15 m 13 s</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(pc1)</code></pre>
<div class="figure">
<img src="figure/powercurve1.svg" alt="plot of chunk powercurve1" /><p class="caption">plot of chunk powercurve1</p>
</div>
<h2 id="tutorial-three">Tutorial Three</h2>
<p>Specify the sample and effect sizes.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fixef</span>(model1)</code></pre>
<pre><code>## (Intercept)           x 
##     10.6734     -0.2398</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fixef</span>(model1)[<span class="st">&quot;x&quot;</span>]</code></pre>
<pre><code>##       x 
## -0.2398</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">model2 &lt;-<span class="st"> </span>model1
<span class="kw">fixef</span>(model2)[<span class="st">&quot;x&quot;</span>] &lt;-<span class="st"> </span>-<span class="fl">0.1</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">pc2 &lt;-<span class="st"> </span><span class="kw">powerCurve</span>(model2)</code></pre>
<pre><code>## Calculating power at 8 sample sizes for x</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(pc2)</code></pre>
<pre><code>## Power to detect effect of x, (95% confidence interval):
## #levels for x 
##       3:   6.90% (  5.41,   8.65)
##       4:   8.40% (  6.76,  10.29)
##       5:  10.50% (  8.67,  12.57)
##       6:  12.60% ( 10.61,  14.82)
##       7:  17.80% ( 15.48,  20.31)
##       8:  20.90% ( 18.42,  23.55)
##       9:  25.90% ( 23.21,  28.73)
##      10:  34.70% ( 31.75,  37.74)
## 
## Time elapsed: 0 h 15 m 24 s</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(pc2)</code></pre>
<div class="figure">
<img src="figure/powercurve2.svg" alt="plot of chunk powercurve2" /><p class="caption">plot of chunk powercurve2</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r">model3 &lt;-<span class="st"> </span><span class="kw">extend</span>(model2, <span class="dt">along =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">n =</span> <span class="dv">20</span>)
pc3 &lt;-<span class="st"> </span><span class="kw">powerCurve</span>(model3)</code></pre>
<pre><code>## Calculating power at 18 sample sizes for x</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(pc3)</code></pre>
<pre><code>## Power to detect effect of x, (95% confidence interval):
## #levels for x 
##       3:   8.80% (  7.12,  10.73)
##       4:   9.40% (  7.66,  11.38)
##       5:  10.30% (  8.49,  12.35)
##       6:  12.90% ( 10.88,  15.14)
##       7:  15.70% ( 13.50,  18.11)
##       8:  18.60% ( 16.23,  21.15)
##       9:  26.50% ( 23.79,  29.35)
##      10:  34.00% ( 31.06,  37.03)
##      11:  44.70% ( 41.59,  47.84)
##      12:  54.50% ( 51.35,  57.62)
##      13:  65.80% ( 62.77,  68.74)
##      14:  73.80% ( 70.96,  76.50)
##      15:  83.00% ( 80.53,  85.28)
##      16:  90.80% ( 88.84,  92.52)
##      17:  94.10% ( 92.46,  95.48)
##      18:  96.70% ( 95.40,  97.72)
##      19:  98.60% ( 97.66,  99.23)
##      20:  99.30% ( 98.56,  99.72)
## 
## Time elapsed: 0 h 31 m 48 s</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(pc3)</code></pre>
<div class="figure">
<img src="figure/powercurve3.svg" alt="plot of chunk powercurve3" /><p class="caption">plot of chunk powercurve3</p>
</div>
<h2 id="tutorial-four">Tutorial Four</h2>
<p>We can have different values for alpha.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(pc3, <span class="dt">pval =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>))</code></pre>
<div class="figure">
<img src="figure/powercurve3multi.svg" alt="plot of chunk powercurve3multi" /><p class="caption">plot of chunk powercurve3multi</p>
</div>
<h2 id="tutorial-five">Tutorial Five</h2>
<p>Extend another dimension.</p>
<pre class="sourceCode r"><code class="sourceCode r">model4 &lt;-<span class="st"> </span><span class="kw">extend</span>(model2, <span class="dt">along =</span> <span class="st">&quot;g&quot;</span>, <span class="dt">n =</span> <span class="dv">15</span>)
pc4 &lt;-<span class="st"> </span><span class="kw">powerCurve</span>(model4, <span class="dt">along =</span> <span class="st">&quot;g&quot;</span>)</code></pre>
<pre><code>## Calculating power at 13 sample sizes for g</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(pc4)</code></pre>
<pre><code>## Power to detect effect of x, (95% confidence interval):
## #levels for g 
##       3:  36.80% ( 33.80,  39.87)
##       4:  46.80% ( 43.67,  49.95)
##       5:  53.70% ( 50.55,  56.83)
##       6:  61.50% ( 58.40,  64.53)
##       7:  68.10% ( 65.11,  70.98)
##       8:  74.10% ( 71.27,  76.79)
##       9:  79.10% ( 76.45,  81.58)
##      10:  84.30% ( 81.89,  86.50)
##      11:  87.60% ( 85.40,  89.58)
##      12:  88.50% ( 86.36,  90.41)
##      13:  91.10% ( 89.16,  92.79)
##      14:  92.30% ( 90.47,  93.88)
##      15:  94.30% ( 92.68,  95.65)
## 
## Time elapsed: 0 h 24 m 16 s</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(pc4)</code></pre>
<div class="figure">
<img src="figure/powercurve41.svg" alt="plot of chunk powercurve4" /><p class="caption">plot of chunk powercurve4</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(pc4, <span class="dt">pval =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>))</code></pre>
<div class="figure">
<img src="figure/powercurve42.svg" alt="plot of chunk powercurve4" /><p class="caption">plot of chunk powercurve4</p>
</div>
</body>
</html>
